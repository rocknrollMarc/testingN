#TODO: Refactor some functions into here. 
# Variable scope is the main issue, to make sure that a user created in registration is passed here